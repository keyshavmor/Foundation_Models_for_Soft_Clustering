/cluster/home/maurdu/Foundation_models_NB/clustering/cancerfnd.py:160: UserWarning: Ground truth key 'cell_state' not found in source adata.obs. Evaluation might fail.
  warnings.warn(f"Ground truth key '{data_keys_cfg['ground_truth_key']}' not found in source adata.obs. Evaluation might fail.")
/cluster/home/maurdu/Foundation_models_NB/clustering/cancerfnd.py:162: UserWarning: Timepoint key 'Stage_Code' not found in source adata.obs. Interpretability analysis might fail.
  warnings.warn(f"Timepoint key '{data_keys_cfg['timepoint_key']}' not found in source adata.obs. Interpretability analysis might fail.")
/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python3.9/site-packages/anndata/_core/anndata.py:844: UserWarning: 
AnnData expects .var.index to contain strings, but got values like:
    ['ISG15', 'TNFRSF4', 'HES5', nan, nan]

    Inferred to be: categorical

  names = self._prep_dim_index(names, "var")
Traceback (most recent call last):
  File "/cluster/home/maurdu/Foundation_models_NB/clustering/cancerfnd.py", line 194, in <module>
    adata = embed(
  File "/cluster/home/maurdu/Foundation_models_NB/clustering/../model/embedding.py", line 56, in embed
    adata.var["id_in_vocab"] = [
  File "/cluster/home/maurdu/Foundation_models_NB/clustering/../model/embedding.py", line 57, in <listcomp>
    vocab[gene] if gene in vocab else -1 for gene in adata.var["genes"]
  File "/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python3.9/site-packages/torchtext/vocab/vocab.py", line 54, in __contains__
    return self.vocab.__contains__(token)
TypeError: __contains__(): incompatible function arguments. The following argument types are supported:
    1. (self: torchtext._torchtext.Vocab, arg0: str) -> bool

Invoked with: <torchtext._torchtext.Vocab object at 0x149e72695e30>, nan
srun: error: eu-g9-004-2: task 0: Exited with exit code 1
