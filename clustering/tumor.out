--- Starting Slurm Job ---
Job ID: 32578435
Running on host: eu-g5-018-1
Initial CWD: /cluster/home/maurdu/Foundation_models_NB/clustering
User: maurdu
Home: /cluster/home/maurdu
-----------------------------
Loading eth_proxy module...
eth_proxy module loaded. HTTP_PROXY=
-----------------------------
Setting up Conda...
Activating Conda environment: cancer_found
Conda environment activated: cancer_found
Python interpreter: /cluster/home/maurdu/miniconda/envs/cancer_found/bin/python
Python version: Python 3.9.21
PYTHONPATH: 
-----------------------------
Attempting to cd to: /cluster/home/maurdu/Foundation_models_NB/clustering
Successfully changed CWD. New CWD: /cluster/home/maurdu/Foundation_models_NB/clustering
-----------------------------
Checking if Python script exists: /cluster/home/maurdu/Foundation_models_NB/clustering/cancerfnd.py
-rw-r--r-- 1 maurdu maurdu-group 57K May 20 14:42 /cluster/home/maurdu/Foundation_models_NB/clustering/cancerfnd.py
Checking if Config file exists: /cluster/home/maurdu/Foundation_models_NB/clustering/config_concat_tumor.yaml
-rw-r--r-- 1 maurdu maurdu-group 5.2K May 17 18:55 /cluster/home/maurdu/Foundation_models_NB/clustering/config_concat_tumor.yaml
-----------------------------
Executing command: python -u -X faulthandler cancerfnd.py --config=config_concat_tumor.yaml
--- PYTHON SCRIPT cancerfnd.py STARTED --- CWD: /cluster/home/maurdu/Foundation_models_NB/clustering
--- PYTHON SCRIPT cancerfnd.py --- Python Executable: /cluster/home/maurdu/miniconda/envs/cancer_found/bin/python
--- PYTHON SCRIPT cancerfnd.py --- sys.path: ['/cluster/home/maurdu/Foundation_models_NB/clustering', '/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python39.zip', '/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python3.9', '/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python3.9/lib-dynload', '/cluster/home/maurdu/miniconda/envs/cancer_found/lib/python3.9/site-packages']
--- Loading Configuration ---
Loaded configuration for: CancerFoundation_NB_Dataset3_Analysis
--- Setting up Paths and Scanpy ---
Scanpy figure directory set to: concat_tumor/results/scanpy_plots
--- Matplotlib plt.show() patched to save figures instead. ---
--- Loading/Generating CancerFoundation Embeddings ---
output_embedded_path is: resources/embeddings/embedding_processed.h5ad
Loading existing embedded AnnData: resources/embeddings/embedding_processed.h5ad
Load complete.
Found embedding key 'CancerGPT' in loaded data.

--- Embedded AnnData Object Info ---
AnnData object with n_obs × n_vars = 53315 × 1197
    obs: 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'percent_mito', 'Study', 'Assay', 'Platform', 'Sample', 'Patient_No', 'Timepoint', 'INSS_stage', 'MYCN_amplification', 'Gender', 'Risk', 'Cell_condition', 'Cell_type', 'cell', 'n_genes', 'leiden', 'cnv_leiden', 'cnv_score', 'cnv_status', 'Stage_Code', 'Tissue', 'Risk_Category', 'First_Avail_TP', 'MYCN_Status', 'ALK_Status', 'TP53_Status', 'Response', 'Vital_Status', 'Age_at_IDX_in_months', 'Treatment', 'First_Avail_Time_Point', 'sample_name', 'biospecimen_id', 'percent.mt', 'seurat_clusters', 'sample_label_wo_prefix', 'S.Score', 'G2M.Score', 'Phase', 'malignancy', 'cell_state', 'RNA_snn_res.0.2', 'MES_Score', 'ADRN_Score', 'MES_ADRN_diff', 'Event', 'organism_ontology_term_id', 'donor_id', 'development_stage_ontology_term_id', 'sex_ontology_term_id', 'disease_ontology_term_id', 'tissue_type', 'cell_type_ontology_term_id', 'assay_ontology_term_id', 'suspension_type', 'tissue_ontology_term_id', 'self_reported_ethnicity_ontology_term_id', 'is_primary_data', 'cell_type', 'assay', 'disease', 'organism', 'sex', 'tissue', 'self_reported_ethnicity', 'development_stage', 'observation_joinid', 'cell_type_joint', 'SAMPLES_JOINT'
    var: 'highly_variable', 'means', 'dispersions', 'dispersions_norm', 'genes', 'n_cells'
    uns: 'SAMPLES_JOINT_colors', 'Stage_Code_colors', 'X_umap_cfnd_bbknn', 'X_umap_cfnd_harmony', 'cell_state_colors', 'cell_type_joint_colors', 'hvg', 'log1p', 'neighbors'
    obsm: 'CancerGPT', 'X_pca', 'X_umap', 'X_umap_cfnd_bbknn', 'X_umap_cfnd_harmony', 'cancerfnd_pca', 'cancerfnd_pca_harmony', 'cancerfnd_z'
    obsp: 'connectivities', 'distances'
Embedding 'CancerGPT' shape: (53315, 256)
adata filtered for cells that have a ground truth value, retaining: (49131, 1197)

--- Calculating Neighbors and UMAP based on 'CancerGPT' ---
UMAP calculated and stored in adata.obsm['X_umap_cfnd_harmony']

==================================================
--- Running Clustering Algorithms ---
==================================================

--- Running Gaussian Mixture Model (GMM) ---
Calculating BIC/AIC for component selection...
  Fitting GMM with 2 components...
